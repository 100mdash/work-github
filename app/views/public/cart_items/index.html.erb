<div class="containar">
  <div class="row col-md-12">
    <h1 class="row col-8 mx-auto">ショッピングカート</h1>
    <div><%= link_to "カートを空にする",public_cart_items_destroy_all_path(@cart_item), method: :delete %></div>
    <table class="table table-striped table-bordered table-sm col-xs-3 col-ms-3 col-md-4 col-lg-4">
      <thead>
        <tr>
          <th>商品名</th>
          <th>単価(税込み)</th>
          <th>数量</th>
          <th>小計</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% total=0 %>
        <% @cart_items.each do |cart_item| %>
         <tr>
           <td>
             <%= attachment_image_tag cart_item.item, :image %>
             <%= cart_item.item.name %>
           </td>
           <td><%= cart_item.item.add_tax_price.to_s(:delimited) %></td>
           <%= form_with model:@cart_item,url:public_cart_items_path, method: :post do |f| %>
           <td>
             <%= f.select :count, options_for_select(@numbers, {selected: cart_item.count.to_i} ) %>
             <div class="btn btn-success btn-xm"><%= link_to "更新",public_cart_item_path(cart_item), method: :patch %></div>
            </td>
            <% end %>
            <td> <%= (cart_item.item.add_tax_price.to_s(:delimited).to_i)*cart_item.count %></td>
            <td class="btn btn-warning"><%= link_to "削除する",public_cart_item_path(cart_item), method: :delete %></td>
            <% total += ((cart_item.item.add_tax_price.to_s(:delimited).to_i)*cart_item.count) %>
         </tr>
        <% end %>
      </tbody>
    </table>
    <table class="table table-striped table-bordered">
      <tbody>
        <tr>
          <td>合計金額</td>
          <td><%= total %></td>
        </tr>
      </tbody>
    </table>
    <div><%= link_to ' 買い物を続ける',public_items_path,class: 'btn btn-success  text-light' %></div>
    <div><%= link_to ' 情報入力に進む',new_public_order_path,class: 'btn btn-success  text-light' %></div>
  </div>
</div>
